import numpy as np

#U238 decay series.
Pa234m = {'name':'PA234M',
          'energy':[1001.03,766.38],
          'br':[0.00837,0.00294]}
Th234 = {'name':'TH234',
         'energy':[112.81],
         'br':[0.00277]}
Ra226 = {'name':'RA226',
         'energy':[186.211],
         'br':[0.0359]}
Pb214 = {'name':'PB214',
         'energy':[351.932,295.224,241.997,53.2275,785.96,839.04,258.87,274.8,487.09,580.13,480.43,462,533.66],
         'br':[0.376,.193,0.0743,0.012,0.0107,0.00587,0.00524,0.00474,0.00422,0.00352,0.0032,0.00221,0.00186]}
Bi214 = {'name':'BI214',
         'energy':[609.312,1764.494,1120.287,1238.11,2204.21,768.356,1377.669,934.061,1729.595,1407.98,1509.228,1847.42,1155.19,2447.86,665.453,1280.96,1401.5,806.174,1661.28,2118.55,
                   1385.31,1583.22,703.11,1207.68,719.86,1538.5,388.88,964.08,1838.36,1051.96,386.77,786.1,2293.4,454.77,1069.96,1594.73,1133.66,1599.31,1873.16,1683.99],
         'br':[0.461,0.154,0.151,0.0579,0.0508,0.0494,0.04,0.0303,0.0292,0.0215,0.0211,0.0211,0.0163,0.0157,0.0146,0.0143,0.0127,0.0122,0.0115,0.0114,
               0.00757,0.0069,0.00472,0.00451,0.00379,0.00376,0.0037,0.00362,0.0036,0.00315,0.0031,0.0031,0.00305,0.003,0.00275,0.0025,0.00248,0.0023,0.00219,0.00216]}

#U235 decay series.
U235 = {'name':'U235',
        'energy':[185.712,143.764,163.358,205.309,109.16,202.111,194.94,182.52,279.5,221.399],
        'br':[0.572,0.1096,0.0508,0.0501,0.0154,0.0108,0.0063,0.0034,0.0027,0.0012]}
Th231 = {'name':'TH231',
         'energy':[102.268],
         'br':[0.0041]}
Pa231 = {'name':'PA231',
         'energy':[300.07,302.65,283.69,283.69,302.65],
         'br':[0.0246,0.022,0.017,0.01396,0.0068]}
Th227 = {'name':'TH227',
         'energy':[235.971,256.25,329.851,300,286.122,304.519,210.65,334.381,254.68,113.159,312.69,296.51,314.78,314.78,234.81,342.5,250.35,300,206.11,204.27],
         'br':[0.123,0.07,0.027,0.0232,0.0154,0.012,0.0111,0.0105,0.007,0.005,0.0048,0.0046,0.0044,0.0044,0.0041,0.0039,0.0034,0.0034,0.0021,0.002]}
Ra223 = {'name':'RA223',
         'energy':[269.459,154.21,323.871,144.232,338.281,445.03,122.319,158.633,371.68,342.90,328.40],
         'br':[0.137,0.0562,0.0393,0.0322,0.0279,0.0127,0.01192,0.00685,0.00480,0.00219,0.00206]}
Rn219 = {'name':'RN219',
         'energy':[271.23,401.81],
         'br':[0.108,0.0637]}
Pb211 = {'name':'PB211',
         'energy':[404.853,832.01,427.088,766.51,704.64,],
         'br':[0.0378,0.0352,0.0176,0.00617,0.00462]}
Bi211 = {'name':'BI211',
         'energy':[351.059],
         'br':[0.1291]}
Tl207 = {'name':'TL207',
         'energy':[897.80],
         'br':[0.0026]}

#TH232 decay series.
Ac228 = {'name':'AC228',
         'energy':[911.204,968.971,338.32,964.766,463.004,794.947,209.253,270.245,1588.19,328,129.065,478.4],
         'br':[0.258,0.158,0.1127,0.0499,0.044,0.0425,0.0389,0.0346,0.0322,0.0295,0.0242,0.209]}
Th228 = {'name':'TH228',
         'energy':[215.983],
         'br':[0.00254]}
Ra224 = {'name':'RA224',
        'energy':[240.986],
         'br':[0.041]}
Pb212 = {'name':'PB212',
         'energy':[238.632,300.087,115.183],
         'br':[0.4334,0.0328,0.00592]}
Bi212 = {'name':'BI212',
         'energy':[727.33,1620.5,785.37,39.858,1078.62,893.408,452.83,288.07,1512.7],
         'br':[0.0658,0.0149,0.01102,0.01091,0.00564,0.00378,0.0031,0.0031,0.0029]}
Tl208 = {'name':'TL208',
         'energy':[2614.533,510.77,860.564,277.351,763.13,252.61,1093.9,233.36,982.7,722.04],
         'br':[0.99,0.226,0.1242,0.0631,0.0181,0.0069,0.004,0.00307,0.00203,0.00201]}

#K40 decay.
K40 = {'name':'K40',
       'energy':[1460.830],
       'br':[0.11]}

def background(energy,deltae=1):


    background_isotopes = [Pa234m,Th234,Ra226,Pb214,Bi214,
                           U235,Th231,Pa231,Th227,Ra223,Rn219,Pb211,Bi211,Tl207,
                           Ac228,Th228,Ra224,Pb212,Bi212,Tl208,
                           K40]

    identified_isotopes = []
    identified_isotopes_energy = []
    identified_isotopes_br = []

#another method to weight the isotopes ?

    for i in range(len(background_isotopes)):
        for j in range(len(background_isotopes[i]['energy'])):
            if (np.isclose(energy,background_isotopes[i]['energy'][j],atol=deltae) == True) and (background_isotopes[i]['br'][j] >= 0.01):
                identified_isotopes.append(background_isotopes[i]['name'])
                identified_isotopes_energy.append(background_isotopes[i]['energy'][j])
                identified_isotopes_br.append(background_isotopes[i]['br'][j])
            else:
                pass


    return identified_isotopes, identified_isotopes_energy, identified_isotopes_br
